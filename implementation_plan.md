# 스테이지 1 구현 계획서: 화상 응급처치 (과학실)

## 1. 개요
- **시나리오**: 초등학교 과학실에서 실험 중 친구가 알코올 램프에 의해 손에 화상을 입은 상황.
- **학습 목표**:
    1. 화상 부위의 열기를 식히는 올바른 방법(흐르는 찬물)을 익힌다.
    2. 화상 관련 민간요법(얼음, 된장 등)의 위험성을 인지한다.
    3. 물집 보호의 중요성과 전문/보건실 치료의 필요성을 이해한다.

## 2. 핵심 게임 시스템 & 상태 관리
### 2.1 생명력(Heart) 및 페널티 시스템
- **하트(목숨)**: 기본 3개 (전역 상태).
- **차감 조건**: 잘못된 아이템 사용, 올바르지 않은 순서로 행동 시 하트 1개 차감.
- **피드백**: 화면이 붉게 깜빡이며, "잘못된 처치법입니다!"와 함께 구체적인 교육적 경고 메시지 팝업 출력.
- **게임 오버**: 하트가 0개가 되면 -> **복습 퀴즈 모달** 출력 (빈칸 채우기) -> 정답 시 스테이지 재시작 (소프트 리셋).

### 2.2 미션 진행 로직 (콤보 시스템)
플레이어는 반드시 다음 순서를 지켜야만 성공으로 인정됩니다:
1. **[열기 식히기]**: 세면대(`Sink`) 또는 생수병(`Water Bottle`) 사용 (3초간 게이지 또는 애니메이션).
2. **[환부 보호]**: 멸균 거즈(`Sterile Gauze`) 아이템을 NPC에게 사용.
3. **[신고 및 탈출]**: 탈출구(`Door Lock`) 상호작용 -> 3문항 퀴즈 풀기 -> 스테이지 클리어.

**순서 위반 페널티**: 열기를 식히지 않고 바로 거즈를 사용하면 페널티 발생 (하트 -1, 경고 메시지).

### 2.3 등급 시스템 (클리어 시)
- **SSS**: 하트 3개 (완벽함)
- **A**: 하트 2개
- **B**: 하트 1개

## 3. 맵 및 오브젝트 (`GameScene.js` & Map JSON)
- **안전 게시판**: 상호작용 오브젝트. 클릭 시 '화상 응급처치 3원칙' 팝업 표시.
- **NPC**: 화상을 입고 울고 있는 상태 (초기 상태).
- **세면대 (Sink)**: 화상 부위를 식힐 수 있는 상호작용 구역.
- **탈출구 (Door Lock)**: 최종 퀴즈 및 클리어 트리거.
- **아이템** (`Collectibles.js`를 통해 스폰):
    - **정답 아이템**: 생수병, 멸균 거즈.
    - **함정 아이템 (오답)**: 얼음팩, 치약, 된장, 바늘.

## 4. UI 구현 (`UI_Scene.js`)
- **하트 표시**: 좌측 상단 HUD에 하트 아이콘 3개 표시.
- **피드백 알림**: 화면 전체 붉은색 점멸 효과 + 텍스트 팝업.
- **대화창**: 기존 시스템 재사용 (NPC 대사, 시스템 메시지).
- **퀴즈 모달**: 탈출용 4지선다 퀴즈 및 게임오버용 빈칸 채우기 퀴즈 UI.

## 5. 구현 단계별 테스크

### 1단계: 데이터 구조 설정
- `Stage1Data.js` 업데이트:
    - 미션 단계 정의 (식히기 -> 보호하기 -> 퀴즈).
    - 아이템 데이터 속성 추가 (`type`: cool, protect, bad / `penaltyMsg`: 교육적 경고문).
    - 퀴즈 데이터 추가 (최종 3문제 + 복습 문제).

### 2단계: 게임 로직 고도화 (`GameScene.js`)
- **상태 관리자 (State Manager)** 추가:
    - `currentStep` (0: 사고발생, 1: 식힘완료, 2: 보호완료, 3: 클리어).
    - `currentHearts` (3).
- **상호작용 로직 구현**:
    - **아이템 사용**: 현재 단계(`currentStep`)와 아이템 속성 비교.
        - 올바른 순서 & 아이템: 단계 진행, 성공 메시지.
        - 틀린 아이템 (함정): 하트 차감, 아이템별 경고 메시지 출력.
        - 틀린 순서 (식히기 전 거즈): 하트 차감, 순서 경고 메시지 출력.
    - **세면대 상호작용**: 1단계 미만일 때만 작동 -> 1단계(식힘완료)로 변경.

### 3단계: UI 업데이트 (`UI_Scene.js`)
- 하트 컨테이너 구현 (하트 개수 변화 시각화).
- "붉은 화면" 점멸 효과 함수 구현.
- 퀴즈 UI 구현 (모달 창 및 버튼 상호작용).

### 4단계: 게임 오버 및 재시작 루프
- 하트 <= 0 조건 체크: 게임 일시정지 -> 복습 퀴즈 모달 출력.
- 복습 로직: 텍스트 입력 또는 선택 -> 정답 확인 -> 하트/위치 초기화 후 재시작.

### 5단계: 최종 폴리싱
- 사운드 추가 (성공음, 실패/버저음, 물 흐르는 소리).
- 시각적 연출 강화 (NPC 상태 변화: 울음 -> 진정 -> 붕대 감음).
